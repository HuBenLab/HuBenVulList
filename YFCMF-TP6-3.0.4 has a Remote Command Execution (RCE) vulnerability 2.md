# YFCMF-TP6-3.0.4 has a Remote Command Execution (RCE) vulnerability
## Description
    YFCMF-TP6-3.0.4 has a Remote Command Execution (RCE) vulnerability
## Vendor Homepage
    https://github.com/0377/yfcmf-tp6,https://www.iuok.cn/

## Author
    HuBenLab
## Proof of Concept
The problem is in `app/admin/controller/Ajax.php` in the lang function, the vulnerability can be in the framework does not open the multilingual when the inclusion of php files to achieve the effect of rce.

Start analyzing the code, first controllerername controllable, follow up loadlang function

![image-20230525150824627](./img/image-20230525150824627.png)

The code above if is used to handle the path, the main code is in the lang::land function below.

![image-20230525150905604](./img/image-20230525150905604.png)

Keeping following up, the load function will take the arguments we pass into the parse function for parsing.

![image-20230525150946467](./img/image-20230525150946467.png)

The next step is to include the php file we control

![image-20230525151013788](./img/image-20230525151013788.png)

![image-20230525151035886](./img/image-20230525151035886.png)

![image-20230525151047037](./img/image-20230525151047037.png)